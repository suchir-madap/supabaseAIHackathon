var O=Object.create;var l=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty;var F=(e,t)=>{for(var n in t)l(e,n,{get:t[n],enumerable:!0})},d=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of L(t))!A.call(e,o)&&o!==n&&l(e,o,{get:()=>t[o],enumerable:!(r=W(t,o))||r.enumerable});return e};var x=(e,t,n)=>(n=e!=null?O(V(e)):{},d(t||!e||!e.__esModule?l(n,"default",{value:e,enumerable:!0}):n,e)),P=e=>d(l({},"__esModule",{value:!0}),e);var C={};F(C,{default:()=>T});module.exports=P(C);var R=x(require("assert")),b=require("@parcel/plugin"),N=require("@parcel/utils");var g=globalThis.process?.argv||[];var y=()=>globalThis.process?.env||{};var S=new Set(g),v=e=>S.has(e),q=g.filter(e=>e.startsWith("--")&&e.includes("=")).map(e=>e.split("=")).reduce((e,[t,n])=>(e[t]=n,e),{});var H=v("--dry-run"),m=()=>v("--verbose")||y().VERBOSE==="true",X=m();var D=(e="",...t)=>console.log(e.padEnd(9),"|",...t);var k=0,E=(...e)=>m()&&D(`\u{1F7E1} ${k++}`,...e);var h=x(require("nullthrows"));var _=require("@parcel/utils");function u(e,t){return(0,_.relativeBundlePath)(e,t,{leadingDotSlash:!1})}var M=(e,t,n,r=[])=>r.map(o=>{let p=n.filter(s=>o.js?.includes(s.id)||o.css?.includes(s.id)).map(s=>(0,h.default)(t.getReferencedBundle(s,e)));o.css=[...new Set((o.css||[]).concat(p.flatMap(s=>t.getReferencedBundles(s)).filter(s=>s.type=="css").map(s=>u(e,s))))];let i=p.flatMap(s=>{let a=[],f=t.getReferencedBundles(s);return t.traverseBundles(c=>{s!==c&&!f.includes(c)&&a.push(c)},s),a}).map(s=>u(e,s));return i.length>0?{matches:o.matches.map(s=>{if(/^(((http|ws)s?)|ftp|\*):\/\//.test(s)){let a=s.indexOf("/",s.indexOf("://")+3);return a===-1&&(a=s.length),s.slice(0,a)+"/*"}return s}),resources:i}:null}).filter(Boolean);function B(e,t,n){let r=(e.web_accessible_resources||[]).concat([...new Set(t.flatMap(o=>o.resources))]);r.length>0&&(e.web_accessible_resources=r)}function w(e,t,n){n.hmrOptions&&t.push({matches:["<all_urls>"],resources:["__plasmo_hmr_proxy__"]}),t.length>0&&(e.web_accessible_resources=(e.web_accessible_resources||[]).concat(t))}var T=new b.Packager({async package({bundle:e,bundleGraph:t,options:n}){E("@plasmohq/parcel-packager");let r=[];e.traverseAssets(c=>{r.push(c)});let o=r.filter(c=>c.meta.webextEntry===!0);(0,R.default)(r.length===2&&o.length===1,"Web extension bundles must contain exactly one manifest asset and one runtime asset");let[p]=o,i=JSON.parse(await p.getCode()),s=p.getDependencies(),a=M(e,t,s,i.content_scripts);i.manifest_version===2?B(i,a,n):w(i,a,n);let{contents:f}=(0,N.replaceURLReferences)({bundle:e,bundleGraph:t,contents:JSON.stringify(i)});return{contents:f}}});
